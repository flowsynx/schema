{
  "$schema": "https://schema.flowsynx.io/workflows/v1.1.0/schema.json",
  "version": "1.1.0",
  "title": "FlowSynx Workflow Definition",
  "type": "object",
  "required": [ "Name", "Tasks" ],
  "patternProperties": {
    "(?i)^Name$": {
      "type": "string",
      "description": "Unique name identifying the workflow."
    },
    "(?i)^Description$": {
      "type": "string",
      "description": "Detailed description of the workflow."
    },
    "(?i)^Variables$": {
      "type": ["object", "null"],
      "description": "A dictionary of variables used in the workflow, accessible in tasks.",
      "additionalProperties": {
        "type": ["string", "number", "boolean", "object", "array", "null"],
        "description": "Variable value, can be any JSON type."
      }
    },
    "(?i)^Configuration$": {
      "type": "object",
      "patternProperties": {
        "(?i)^DegreeOfParallelism$": {
          "type": "integer",
          "minimum": 1,
          "description": "Maximum number of tasks to execute concurrently."
        },
        "(?i)^Timeout$": {
          "type": "integer",
          "minimum": 0,
          "description": "Workflow-level timeout in milliseconds."
        },
        "(?i)^ErrorHandling$": {
          "type": "object",
          "patternProperties": {
            "(?i)^Strategy$": {
              "type": "string",
              "pattern": "(?i)^(Abort|Skip|Retry)$",
              "description": "Defines how the workflow reacts when a task fails."
            },
            "(?i)^RetryPolicy$": {
              "type": "object",
              "patternProperties": {
                "(?i)^MaxRetries$": {
                  "type": "integer",
                  "minimum": 0,
                  "default": 3,
                  "description": "Maximum number of retry attempts for failed tasks."
                },
                "(?i)^BackoffStrategy$": {
                  "type": "string",
                  "pattern": "(?i)^(Fixed|Linear|Exponential|Jitter)$",
                  "default": "Fixed",
                  "description": "Strategy used to determine the delay between retries."
                },
                "(?i)^InitialDelay$": {
                  "type": "integer",
                  "minimum": 0,
                  "default": 1000,
                  "description": "Initial delay (in milliseconds) before the first retry."
                },
                "(?i)^MaxDelay$": {
                  "type": "integer",
                  "minimum": 0,
                  "default": 10000,
                  "description": "Maximum delay (in milliseconds) between retries."
                },
                "(?i)^BackoffCoefficient$": {
                  "type": "number",
                  "minimum": 0,
                  "default": 2.0,
                  "description": "Multiplier applied to the delay for exponential backoff."
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "(?i)^Tasks$": {
      "type": "array",
      "minItems": 1,
      "description": "List of tasks that make up the workflow.",
      "items": {
        "type": "object",
        "required": [ "Name", "Type" ],
        "patternProperties": {
          "(?i)^Name$": {
            "type": "string",
            "description": "Unique name identifying the task."
          },
          "(?i)^Description$": {
            "type": ["string", "null"],
            "description": "Optional description of the task."
          },
          "(?i)^Type$": {
            "oneOf": [
              {
                "type": "string",
                "description": "Built-in or custom task type identifier."
              },
              {
                "type": "object",
                "required": [ "Plugin", "Version" ],
                "patternProperties": {
                  "(?i)^Plugin$": {
                    "type": "string",
                    "description": "Name of the plugin providing this task."
                  },
                  "(?i)^Version$": {
                    "type": "string",
                    "description": "Version of the plugin used."
                  },
                  "(?i)^Specifications$": {
                    "type": "object",
                    "description": "Plugin-specific configuration options.",
                    "additionalProperties": true
                  }
                },
                "additionalProperties": false
              }
            ]
          },
          "(?i)^Timeout$": {
            "type": "integer",
            "minimum": 0,
            "description": "Optional timeout for the task in milliseconds."
          },
          "(?i)^Dependencies$": {
            "type": "array",
            "items": { "type": "string" },
            "description": "Names of tasks that must complete before this task starts."
          },
          "(?i)^Parameters$": { 
            "type": "object",
            "description": "Task-specific input parameters.",
            "additionalProperties": true
          },
          "(?i)^ErrorHandling$": {
            "type": "object",
            "description": "Optional error handling configuration for the task.",
            "patternProperties": {
              "(?i)^Strategy$": {
                "type": "string",
                "pattern": "(?i)^(Abort|Skip|Retry)$",
                "default": "Abort",
                "description": "Defines how the task reacts when an error occurs."
              },
              "(?i)^RetryPolicy$": {
                "type": "object",
                "description": "Retry policy configuration for the task.",
                "patternProperties": {
                  "(?i)^MaxRetries$": {
                    "type": "integer",
                    "minimum": 0,
                    "default": 3,
                    "description": "Maximum number of retry attempts for failed tasks."
                  },
                  "(?i)^BackoffStrategy$": {
                    "type": "string",
                    "pattern": "(?i)^(Fixed|Linear|Exponential|Jitter)$",
                    "default": "Fixed",
                    "description": "Strategy used to determine the delay between retries."
                  },
                  "(?i)^InitialDelay$": {
                    "type": "integer",
                    "minimum": 0,
                    "default": 1000,
                    "description": "Initial delay (in milliseconds) before the first retry."
                  },
                  "(?i)^MaxDelay$": {
                    "type": "integer",
                    "minimum": 0,
                    "default": 10000,
                    "description": "Maximum delay (in milliseconds) between retries."
                  },
                  "(?i)^BackoffCoefficient$": {
                    "type": "number",
                    "minimum": 0,
                    "default": 2.0,
                    "description": "Multiplier applied to the delay for exponential backoff."
                  }
                },
                "additionalProperties": false
              }
            },
            "additionalProperties": false
          },
          "(?i)^Output$": {
            "type": "string",
            "default": "",
            "description": "Optional output of the task."
          },
          "(?i)^Position$": {
            "type": "object",
            "required": [ "X", "Y" ],
            "patternProperties": {
              "(?i)^X$": {
                "type": "number",
                "description": "Horizontal coordinate for visual placement."
              },
              "(?i)^Y$": {
                "type": "number",
                "description": "Vertical coordinate for visual placement."
              }
            },
            "additionalProperties": false
          }
        },
        "additionalProperties": false
      }
    }
  },
  "additionalProperties": false
} 